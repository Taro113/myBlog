<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>唯有爱与生活不可辜负 | 郜健宇的个人博客</title>
    <meta name="description" content="郜健宇的个人博客-描述">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/myBlog/assets/style.CMct_efZ.css" as="style">
    <link rel="preload stylesheet" href="/myBlog/vp-icons.css" as="style">
    <script type="module" src="/myBlog/assets/chunks/metadata.2884eae6.js"></script>
    <script type="module" src="/myBlog/assets/app.CCmBFcMK.js"></script>
    <link rel="preload" href="/myBlog/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/myBlog/assets/chunks/theme.DfO345Br.js">
    <link rel="modulepreload" href="/myBlog/assets/chunks/framework.C8THFwVE.js">
    <link rel="modulepreload" href="/myBlog/assets/04.代码宇宙_01.唯有爱与生活不可辜负.md.CpLYm2sI.lean.js">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body><!--teleport start anchor--><div style="display:none;" class="tk-spotlight-hover tk-spotlight-hover__aside" aria-hidden="true" focusable="false"></div><!--teleport anchor-->
    <div id="app"><!--[--><!--v-if--><!--v-if--><!--v-if--><!--[--><div class="tk-body-bg-image" style="--tk-body-bg-img:url(/myBlog/bg/cover1.jpg) center center / cover no-repeat;--tk-body-bg-img-opacity:0.6;--tk-body-mask-bg-color:rgba(0, 0, 0, 0.2);"><!--v-if--></div><!----><!--v-if--><div class="tk-right-bottom-button tk-wallpaper-outside flx-column"><!--[--><!--]--><div title="返回顶部" class="tk-right-bottom-button__button back-top" style="--tk-progress:0;display:none;" role="button" aria-label="返回顶部" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><i class="tk-icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg
    t="1741888593841"
    class="icon"
    viewBox="0 0 1024 1024"
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    p-id="9313"
    width="200"
    height="200"
  >
    <path
      fill="currentColor"
      d="M760.789 439.887C764.394 155.042 530.029 25.24 512 14.423c-14.423 7.21-252.394 137.014-248.789 425.464-46.873 32.451-97.352 86.536-90.14 180.282 7.21 93.746 100.957 158.648 137.014 155.042 36.056-3.605 25.239-28.845 25.239-28.845l10.817-50.479s54.084 79.324 68.507 79.324h194.704c18.028 0 68.507-79.324 68.507-79.324l10.817 50.48s-10.817 25.239 25.24 28.844c36.056 3.606 129.802-61.296 137.014-155.042 7.21-93.746-43.268-147.831-90.141-180.282zM512 436.282c-7.211 0-93.746-3.606-104.563-104.564C411.042 234.366 504.789 227.155 512 223.55c7.211 0 100.958 10.817 104.563 108.17C605.746 432.675 519.211 436.281 512 436.281z m-54.085 493.972c0 10.816-10.816 21.633-21.633 21.633-10.817 0-21.634-10.817-21.634-21.633V825.69c0-10.817 10.817-21.634 21.634-21.634s21.633 10.817 21.633 21.634v104.564z m79.325 54.084c0 10.817-10.817 21.634-21.634 21.634s-21.634-10.817-21.634-21.634V829.296c0-10.817 10.817-21.634 21.634-21.634s21.633 10.817 21.633 21.634v155.042z m72.112-79.324c0 10.817-10.817 21.634-21.634 21.634s-21.633-10.817-21.633-21.634v-75.718c0-10.817 10.816-21.634 21.633-21.634 10.817 0 21.634 10.817 21.634 21.634v75.718z m0 0"
      p-id="9314"
    ></path>
  </svg></i></div><div title="前往评论" class="tk-right-bottom-button__button" role="button" aria-label="前往评论" style="display:none;"><i class="tk-icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
    <path
      fill="currentColor"
      d="M273.536 736H800a64 64 0 0 0 64-64V256a64 64 0 0 0-64-64H224a64 64 0 0 0-64 64v570.88zM296 800 147.968 918.4A32 32 0 0 1 96 893.44V256a128 128 0 0 1 128-128h576a128 128 0 0 1 128 128v416a128 128 0 0 1-128 128z"
    ></path>
    <path
      fill="currentColor"
      d="M512 499.2a51.2 51.2 0 1 1 0-102.4 51.2 51.2 0 0 1 0 102.4zm192 0a51.2 51.2 0 1 1 0-102.4 51.2 51.2 0 0 1 0 102.4zm-384 0a51.2 51.2 0 1 1 0-102.4 51.2 51.2 0 0 1 0 102.4z"
    ></path>
  </svg></i></div><!--v-if--><!--[--><!--]--></div><!--]--><div class="Layout tk-layout tk-layout--hide-vp-home has-sidebar-trigger" data-v-9a104c51><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-9a104c51 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/myBlog/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>郜健宇的个人博客</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>🚀 进化志</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>美团四大名著</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/growth/9703d2.html" data-v-35975db6><!--[--><span data-v-35975db6>走进高效能人士的七个习惯</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>⚙️ 代码宇宙</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link active" href="/myBlog/tech/7121d4.html" data-v-35975db6><!--[--><span data-v-35975db6>唯有爱与生活不可辜负</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>☕ Java</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/4df292.html" data-v-35975db6><!--[--><span data-v-35975db6>LocalDateTime使用</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>🔧 框架与库</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/86f7a8.html" data-v-35975db6><!--[--><span data-v-35975db6>MyBatis</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/9660f6.html" data-v-35975db6><!--[--><span data-v-35975db6>MyBatis-Plus</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/5b55ae.html" data-v-35975db6><!--[--><span data-v-35975db6>SpringCloud</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/e06551.html" data-v-35975db6><!--[--><span data-v-35975db6>Redis</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>🗄️ 数据库</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/c05570.html" data-v-35975db6><!--[--><span data-v-35975db6>DB数据类型一致性风险治理方案</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/f8b33c.html" data-v-35975db6><!--[--><span data-v-35975db6>xml文件符号表示</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/tech/d10041.html" data-v-35975db6><!--[--><span data-v-35975db6>SQL常用语句</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>⚡ 效率工具箱</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/markdown.html" data-v-35975db6><!--[--><span data-v-35975db6>Markdown Examples</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/myBlog/api.html" data-v-35975db6><!--[--><span data-v-35975db6>Runtime API Examples</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>📦 作品集</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/markdown.html" data-v-35975db6><!--[--><span data-v-35975db6>Markdown Examples</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/api.html" data-v-35975db6><!--[--><span data-v-35975db6>Runtime API Examples</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>💡 灵感抽屉</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/markdown.html" data-v-35975db6><!--[--><span data-v-35975db6>Markdown Examples</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/api.html" data-v-35975db6><!--[--><span data-v-35975db6>Runtime API Examples</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>🎨 热爱清单</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/markdown.html" data-v-35975db6><!--[--><span data-v-35975db6>Markdown Examples</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/api.html" data-v-35975db6><!--[--><span data-v-35975db6>Runtime API Examples</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>📚 精神食粮</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/markdown.html" data-v-35975db6><!--[--><span data-v-35975db6>Markdown Examples</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/api.html" data-v-35975db6><!--[--><span data-v-35975db6>Runtime API Examples</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>🌿 心语角落</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/markdown.html" data-v-35975db6><!--[--><span data-v-35975db6>Markdown Examples</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/myBlog/api.html" data-v-35975db6><!--[--><span data-v-35975db6>Runtime API Examples</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Taro113/myBlog" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Taro113/myBlog" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><!--[--><!--]--><!--[--><div class="tk-theme-enhance flx-align-center"><!--[--><i class="tk-icon" style="--icon-size:20px;--icon-color-hover:var(--tk-theme-color);"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
    <path
      fill="currentColor"
      d="m512 863.36 384-54.848v-638.72L525.568 222.72a96 96 0 0 1-27.136 0L128 169.792v638.72zM137.024 106.432l370.432 52.928a32 32 0 0 0 9.088 0l370.432-52.928A64 64 0 0 1 960 169.792v638.72a64 64 0 0 1-54.976 63.36l-388.48 55.488a32 32 0 0 1-9.088 0l-388.48-55.488A64 64 0 0 1 64 808.512v-638.72a64 64 0 0 1 73.024-63.36z"
    ></path>
    <path fill="currentColor" d="M480 192h64v704h-64z"></path>
  </svg></i><!--]--></div><!--teleport start--><!--teleport end--><!--]--><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-9a104c51 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-9a104c51 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--[--><!--v-if--><!--]--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><!----><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/01.%E5%94%AF%E6%9C%89%E7%88%B1%E4%B8%8E%E7%94%9F%E6%B4%BB%E4%B8%8D%E5%8F%AF%E8%BE%9C%E8%B4%9F.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>唯有爱与生活不可辜负</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h3 class="text" data-v-b3fd67f8>Java</h3><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/10.Java/01.LocalDateTime%E4%BD%BF%E7%94%A8.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>LocalDateTime使用</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h3 class="text" data-v-b3fd67f8>框架与库</h3><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/20.%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/01.spring.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>spring</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/20.%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/02.MyBatis.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>MyBatis</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/20.%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/03.MyBatis-Plus.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>MyBatis-Plus</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/20.%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/04.Springboot.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Springboot</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/20.%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/10.Spring%20cloud%20%E6%8A%80%E6%9C%AF%E7%BB%84%E4%BB%B6%E8%81%94%E7%B3%BB.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Spring cloud 技术组件联系</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/20.%E6%A1%86%E6%9E%B6%E4%B8%8E%E5%BA%93/20.redis.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>redis</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h3 class="text" data-v-b3fd67f8>数据库</h3><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/40.%E6%95%B0%E6%8D%AE%E5%BA%93/01.DB%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B8%80%E8%87%B4%E6%80%A7%E9%A3%8E%E9%99%A9%E6%B2%BB%E7%90%86%E6%96%B9%E6%A1%88.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>DB数据类型一致性风险治理方案</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/40.%E6%95%B0%E6%8D%AE%E5%BA%93/02.xml%E6%96%87%E4%BB%B6%E7%AC%A6%E5%8F%B7%E8%A1%A8%E7%A4%BA.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>xml文件符号表示</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/40.%E6%95%B0%E6%8D%AE%E5%BA%93/03.SQL%E5%B8%B8%E7%94%A8%E8%AF%AD%E5%8F%A5.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>SQL常用语句</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><p class="text" data-v-b3fd67f8>效率工具箱</p><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-9a104c51 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>目录导航</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--[--><!--[--><!--[--><!--]--><!--[--><!--[--><!--]--><div class="tk-article-analyze flx-justify-between" aria-label="文章分析"><div class="tk-article-breadcrumb" role="navigation" aria-label="文章面包屑"><div class="tk-breadcrumb" role="navigation" aria-label="面包屑"><!--[--><span class="tk-breadcrumb__item"><span class="tk-breadcrumb__inner" role="link"><!--[--><a href="/myBlog/" title="首页" class="home hover-color" aria-label="首页"><i class="tk-icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
    <path
      fill="currentColor"
      d="M192 413.952V896h640V413.952L512 147.328zM139.52 374.4l352-293.312a32 32 0 0 1 40.96 0l352 293.312A32 32 0 0 1 896 398.976V928a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V398.976a32 32 0 0 1 11.52-24.576"
    ></path>
  </svg></i></a><!--]--></span><span class="tk-breadcrumb__separator" role="presentation">/</span></span><!--[--><span class="tk-breadcrumb__item"><span class="tk-breadcrumb__inner" role="link"><!--[--><span href title="代码宇宙" class="" aria-label="代码宇宙">代码宇宙</span><!--]--></span><span class="tk-breadcrumb__separator" role="presentation">/</span></span><!--]--><!--]--></div></div><div class="tk-article-analyze__wrapper flx-align-center"><div class="tk-article-info article" role="group" aria-label="文章信息"><!--[--><!--[--><span class="tk-article-info__item" role="group" aria-label="作者"><i class="tk-icon tk-article-info__icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
  <path
    fill="currentColor"
    d="M512 512a192 192 0 1 0 0-384 192 192 0 0 0 0 384m0 64a256 256 0 1 1 0-512 256 256 0 0 1 0 512m320 320v-96a96 96 0 0 0-96-96H288a96 96 0 0 0-96 96v96a32 32 0 1 1-64 0v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 1 1-64 0"
  ></path>
</svg></i><a title="作者" target="_self" class="hover-color" aria-label="郜健宇">郜健宇</a></span><!--]--><!--[--><span class="tk-article-info__item" role="group" aria-label="创建时间"><i class="tk-icon tk-article-info__icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
  <path
    fill="currentColor"
    d="M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"
  ></path>
</svg></i><a title="创建时间" class="hover-color" aria-label="2023-01-13">2023-01-13</a></span><!--]--><!--[--><!--v-if--><!--]--><!--[--><!--v-if--><!--]--><!--[--><!--v-if--><!--]--><!--]--><!--[--><!--]--></div><div class="flx-center"><i class="tk-icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
    <path
      fill="currentColor"
      d="m512 863.36 384-54.848v-638.72L525.568 222.72a96 96 0 0 1-27.136 0L128 169.792v638.72zM137.024 106.432l370.432 52.928a32 32 0 0 0 9.088 0l370.432-52.928A64 64 0 0 1 960 169.792v638.72a64 64 0 0 1-54.976 63.36l-388.48 55.488a32 32 0 0 1-9.088 0l-388.48-55.488A64 64 0 0 1 64 808.512v-638.72a64 64 0 0 1 73.024-63.36z"
    ></path>
    <path fill="currentColor" d="M480 192h64v704h-64z"></path>
  </svg></i><a title="文章字数" class="hover-color" aria-label="文章字数">9536</a></div><div class="flx-center"><i class="tk-icon" style="--icon-color-hover:var(--tk-theme-color);"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
    <path
      fill="currentColor"
      d="M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"
    ></path>
    <path fill="currentColor" d="M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"></path>
    <path fill="currentColor" d="M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"></path>
  </svg></i><a title="预计阅读时长" class="hover-color" aria-label="预计阅读时长">38m</a></div><div class="flx-center"><i class="tk-icon" style="--icon-color-hover:var(--tk-theme-color);"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
    <path
      fill="currentColor"
      d="M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"
    ></path>
  </svg></i><a title="浏览量" class="hover-color" aria-label="浏览量">0</a></div></div></div><!--[--><!--]--><!--]--><!----><!----><!----><!--v-if--><!--[--><div class="tk-sidebar-trigger" title="侧边栏展开/折叠" role="button" aria-label="侧边栏展开/折叠"><div class="tk-right-bottom-button__button"><i class="tk-icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg
    viewBox="0 0 48 48"
    display="inline-block"
    vertical-align="middle"
    min-width="1.2rem"
    width="1.2em"
    height="1.2em"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="4">
      <path d="M6 7h36M8 24h32" />
      <path stroke-linejoin="round" d="M13.99 30L8 24.005L14 18m20.01 0L40 23.995L34 30" />
      <path d="M6 41h36" />
    </g>
  </svg></i></div></div><!--]--><!--]--><!--]--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _myBlog_04_%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99_01_%E5%94%AF%E6%9C%89%E7%88%B1%E4%B8%8E%E7%94%9F%E6%B4%BB%E4%B8%8D%E5%8F%AF%E8%BE%9C%E8%B4%9F" data-v-39a288b8><div><h1 id="唯有爱与生活不可辜负" tabindex="-1">唯有爱与生活不可辜负 <a class="header-anchor" href="#唯有爱与生活不可辜负" aria-label="Permalink to &quot;唯有爱与生活不可辜负&quot;">​</a></h1><p>此文章的目的是为了记录自己所学，并时常进行复习</p><p><strong>注意：</strong> 此文章并不是面试资料，想要有效提高面试成功率，还是得背八股文</p><hr><p>参考资料：</p><p>Java 全栈知识体系         ：<a href="https://pdai.tech/" target="_blank" rel="noreferrer">https://pdai.tech/</a></p><p>idaSmilence-javaDesign：<a href="https://github.com/idaSmilence/javaDesign" target="_blank" rel="noreferrer">https://github.com/idaSmilence/javaDesign</a></p><p>程序员进阶之路             ： <a href="https://tobebetterjavaer.com/" target="_blank" rel="noreferrer">https://tobebetterjavaer.com/</a></p><p>三级小野怪-设计模式    ： <a href="https://blog.csdn.net/zhengzhb/category_926691.html" target="_blank" rel="noreferrer">https://blog.csdn.net/zhengzhb/category_926691.html</a></p><p>菜鸟教程                        ： <a href="https://www.runoob.com/" target="_blank" rel="noreferrer">https://www.runoob.com/</a></p><h1 id="java-基础" tabindex="-1">Java 基础 <a class="header-anchor" href="#java-基础" aria-label="Permalink to &quot;Java 基础&quot;">​</a></h1><h2 id="一、面向对象" tabindex="-1">一、面向对象 <a class="header-anchor" href="#一、面向对象" aria-label="Permalink to &quot;一、面向对象&quot;">​</a></h2><h3 id="_1-定义" tabindex="-1">1. 定义 <a class="header-anchor" href="#_1-定义" aria-label="Permalink to &quot;1. 定义&quot;">​</a></h3><blockquote><p>将事务的属性及行为封装成对象，通过不同对象间的相互调用，组合解决问题</p></blockquote><h3 id="_2-三大特性" tabindex="-1">2. 三大特性 <a class="header-anchor" href="#_2-三大特性" aria-label="Permalink to &quot;2. 三大特性&quot;">​</a></h3><h5 id="_2-1-封装" tabindex="-1">2.1 封装 <a class="header-anchor" href="#_2-1-封装" aria-label="Permalink to &quot;2.1 封装&quot;">​</a></h5><blockquote><p>利用<strong>抽象数据类型</strong>将数据和基于数据的操作封装在一起，数据被保护在抽象数据类型内部，尽可能的隐藏内部细节，只提供一些对外接口与外部发生联系。</p><p>用户无需知道对象内部细节，但可以通过访问外部接口来访问该对象</p></blockquote><p><strong>优点：</strong> 低耦合、高保密、高安全</p><h5 id="_2-2-继承" tabindex="-1">2.2 继承 <a class="header-anchor" href="#_2-2-继承" aria-label="Permalink to &quot;2.2 继承&quot;">​</a></h5><blockquote><p>在原有功能的基础上，既可以重写某功能，也可以拓展新的功能</p><p>所以，子类会具有父类的一般特性，也会有自身的特性</p></blockquote><p><strong>注：</strong> 继承必须要遵循里氏替换原则，也就是，子类可以扩展父类的功能，但不能改变父类原有的功能</p><h5 id="_2-3-多态" tabindex="-1">2.3 多态 <a class="header-anchor" href="#_2-3-多态" aria-label="Permalink to &quot;2.3 多态&quot;">​</a></h5><blockquote><p>同一个行为具有不同的表现形式</p><p>同一行为发生在不同对象上，会产生不同的结果</p></blockquote><p>运行时多态有三个条件：<strong>继承</strong>、<strong>重写</strong>、<strong>向上转型</strong></p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Animal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {								</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 父类</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> play</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Animal.play()...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Animal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {					</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 子类继承父类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> play</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {							</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 重写 play 方法</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Cat.play()...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] args) {</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	Animal animal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Cat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();						</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 向上转型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	animal.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">play</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();									</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Cat.play()...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>实现原理：</strong></p><p>关于重载是否属于多态，可以参考这篇文章：<a href="https://blog.csdn.net/daponi/article/details/88414438" target="_blank" rel="noreferrer">重载是不是多态？重载是不是面向对象？</a></p><p>个人理解：</p><ul><li><p>重载是一个类的行为的多态性的体现，而重写是父类与子类之间多态性的体现</p></li><li><p>重载是多态的静态绑定（编译时多态），重写是多态的动态绑定（运行时多态）</p></li><li><p><strong>静态绑定</strong>：在<strong>编译期</strong>确定，把方法调用与方法实现关联起来，比如方法的<strong>重载</strong></p></li><li><p><strong>动态绑定</strong>：在<strong>运行时</strong>确定，把方法调用与方法实现关联起来，比如方法的<strong>重写</strong></p></li></ul><h2 id="二、数据类型" tabindex="-1">二、数据类型 <a class="header-anchor" href="#二、数据类型" aria-label="Permalink to &quot;二、数据类型&quot;">​</a></h2><h3 id="_1-基本数据类型" tabindex="-1">1. 基本数据类型 <a class="header-anchor" href="#_1-基本数据类型" aria-label="Permalink to &quot;1. 基本数据类型&quot;">​</a></h3><table tabindex="0"><thead><tr><th>类型</th><th>位数(bit)</th><th>范围</th><th>默认值</th><th>包装类</th></tr></thead><tbody><tr><td><code>byte</code></td><td>8</td><td>-2^7 ~ 2^7-1</td><td>0</td><td><code>Byte</code></td></tr><tr><td><code>short</code></td><td>16</td><td>-2^15 ~ 2^15-1</td><td>0</td><td><code>Short</code></td></tr><tr><td><code>int</code></td><td>32</td><td>-2^31 ~ 2^31-1</td><td>0</td><td><code>Integer</code></td></tr><tr><td><code>long</code></td><td>64</td><td>-2^63 ~ 2^63-1</td><td>0L</td><td><code>Long</code></td></tr><tr><td><code>float</code></td><td>32</td><td></td><td>0.0f</td><td><code>Float</code></td></tr><tr><td><code>double</code></td><td>64</td><td></td><td>0.0d</td><td><code>Double</code></td></tr><tr><td><code>char</code></td><td>16</td><td>\u0000 ~ \uffff</td><td>\u0000</td><td><code>Char</code></td></tr><tr><td><code>boolean</code></td><td>1</td><td></td><td>false</td><td><code>Boolean</code></td></tr></tbody></table><ul><li>基本类型与其对应的包装类型之间的赋值使用<strong>自动装箱与自动拆箱</strong>完成</li></ul><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Integer x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自动装箱 调用了 Integer.valueOf(2)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自动拆箱 调用了 x.intValue()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_2-缓存池" tabindex="-1">2. 缓存池 <a class="header-anchor" href="#_2-缓存池" aria-label="Permalink to &quot;2. 缓存池&quot;">​</a></h3><p>基本类型对应的缓冲池如下:</p><ul><li>boolean values true and false</li><li>all byte values(between -128 and 127)</li><li>short values between -128 and 127</li><li>int values between -128 and 127</li><li>char in the range \u0000 to \u007F</li></ul><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Integer x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y);    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// false</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Integer z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Integer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">valueOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Integer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">valueOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k);   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>valueOf()</code> 方法的实现比较简单，就是先判断值是否在缓存池中，如果在的话就直接返回缓存池的内容</li><li>在<strong>缓冲池范围内</strong>的基本类型自动装箱过程就是调用了 <code>valueOf()</code> 方法</li></ul><h3 id="_3-引用数据类型" tabindex="-1">3. 引用数据类型 <a class="header-anchor" href="#_3-引用数据类型" aria-label="Permalink to &quot;3. 引用数据类型&quot;">​</a></h3><blockquote><p>除了基本数据类型以外的类型，都是所谓的引用类型</p><p>常见的有<strong>数组</strong>、类、接口......</p></blockquote><h2 id="三、string" tabindex="-1">三、String <a class="header-anchor" href="#三、string" aria-label="Permalink to &quot;三、String&quot;">​</a></h2><h3 id="_1-概览" tabindex="-1">1. 概览 <a class="header-anchor" href="#_1-概览" aria-label="Permalink to &quot;1. 概览&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    implements</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> java.io.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Serializable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Comparable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CharSequence</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /** The value is used for character storage. */</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value[];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol><li><code>String</code> 类被声明为 final，因此它不可被继承</li><li>内部使用 char 类型保存数据，且被声明为 final，因此保证不可变</li></ol><p><strong>不可变的好处：</strong></p><ol><li>可以缓存 hash 值 <br> 因为 <code>String</code> 的 hash 值经常被使用，比如被用作 HashMap 的 key 值。不可变的特性使得 hash 值也不可变，因此只需要进行一次计算</li><li><code>String Pool</code> 的需要 <br> 如果一个 <code>String</code> 对象已经被创建过了，那么就会从 <code>String Pool</code> 中取得引用。只有 <code>String</code> 是不可变的，才可能使用 <code>String Pool</code></li><li>线程安全 <br> 不可变性使得 <code>String</code> 天生具有不可变性，可以在多个线程中安全地使用</li></ol><h3 id="_2-string、stringbuffer、stringbuilder" tabindex="-1">2. <code>String</code>、<code>StringBuffer</code>、<code>StringBuilder</code> <a class="header-anchor" href="#_2-string、stringbuffer、stringbuilder" aria-label="Permalink to &quot;2. `String`、`StringBuffer`、`StringBuilder`&quot;">​</a></h3><ol><li><strong>可变性：</strong></li></ol><ul><li><code>String</code> 不可变，如果尝试改变则会创建另一个对象</li><li><code>StringBuffer</code> 和 <code>StringBuilder</code> 是可变的</li></ul><ol start="2"><li><strong>线程安全性：</strong></li></ol><ul><li><code>String</code> 天生线程安全</li><li><code>StringBuffer</code> 是线程安全的，内部使用 <code>synchronized</code> 进行同步</li><li><code>StringBuilder</code> 线程不安全，因此最好用于单线程</li></ul><h3 id="_3-intern" tabindex="-1">3. intern() <a class="header-anchor" href="#_3-intern" aria-label="Permalink to &quot;3. intern()&quot;">​</a></h3><blockquote><p>先把当前对象放到 <code>String Pool</code>(字符串常量池)中，然后返回这个对象引用</p></blockquote><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String str </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;			</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 这种方式会自动将新建的对象放入 String Pool 中</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String str1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String str2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;abc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">intern</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(str1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> str2);		</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// true</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">str1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;def&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(str2);       		</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// abc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>思考一下：为什么 str2 还是 &quot;abc&quot;？</strong></p><h2 id="四、泛型" tabindex="-1">四、泛型 <a class="header-anchor" href="#四、泛型" aria-label="Permalink to &quot;四、泛型&quot;">​</a></h2><h3 id="_1-概述" tabindex="-1">1. 概述 <a class="header-anchor" href="#_1-概述" aria-label="Permalink to &quot;1. 概述&quot;">​</a></h3><blockquote><p>参数化类型，就是指定形参的类型<br> Java 编译器是通过先检查代码中泛型的类型，再进行类型擦除，最后编译</p></blockquote><h3 id="_2-类型擦除" tabindex="-1">2. 类型擦除 <a class="header-anchor" href="#_2-类型擦除" aria-label="Permalink to &quot;2. 类型擦除&quot;">​</a></h3><h5 id="_2-1-定义" tabindex="-1">2.1 定义 <a class="header-anchor" href="#_2-1-定义" aria-label="Permalink to &quot;2.1 定义&quot;">​</a></h5><blockquote><p>但要知道的是，Java 的泛型是<strong>伪泛型</strong>，就是 Java 在编译期间，所有的泛型信息都会被擦掉， 如 List&lt;String&gt; 等类型，在编译之后都会变成 List。<br> JVM 看到的只是 List，而由泛型附加的类型信息对 JVM 来说是不可见的。 因此可以通过反射添加其它类型元素</p></blockquote><h5 id="_2-2-意义" tabindex="-1">2.2 意义 <a class="header-anchor" href="#_2-2-意义" aria-label="Permalink to &quot;2.2 意义&quot;">​</a></h5><blockquote><p>代码复用（多种数据类型执行相同的代码）</p></blockquote><p>例子如下：</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b) { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b; }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> float</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b) { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b; }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> double</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b) { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b; }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 使用泛型简化代码：</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T extends Number</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> double</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (T a, T b) { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doubleValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doubleValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="_2-3-缺点" tabindex="-1">2.3 缺点 <a class="header-anchor" href="#_2-3-缺点" aria-label="Permalink to &quot;2.3 缺点&quot;">​</a></h5><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; strs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; ints </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;&gt;();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * obj.getClass()方法返回的是这个对象的 Class 对象，其保存在 ArrayList.class 中</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(strs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ints.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());				</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// true，原因：类型擦除</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 有两个类：Animal 和 Dog，其中 Dog 是 Animal 的子类</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Animal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; dogs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Dog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();							</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 报错</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Animal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; dogs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Dog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();					</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 正确</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="_2-4-原始类型" tabindex="-1">2.4 原始类型 <a class="header-anchor" href="#_2-4-原始类型" aria-label="Permalink to &quot;2.4 原始类型&quot;">​</a></h5><blockquote><p>擦除去了泛型信息，最后在字节码中的类型变量的真正类型.<br> 类型变量擦除，并使用其限定类型（无限定的变量用Object）替换</p></blockquote><h3 id="_3-泛型方法" tabindex="-1">3. 泛型方法 <a class="header-anchor" href="#_3-泛型方法" aria-label="Permalink to &quot;3. 泛型方法&quot;">​</a></h3><ol><li>格式定义 <img src="/myBlog/imgs/20230116000030.png" alt="" loading="lazy">)</li><li>调用格式</li></ol><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Object userObj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BeanUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, User.class);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="3"><li>注意事项</li></ol><ul><li>泛型方法中不能直接 new 一个泛型类型，因为不知道其构造方法是怎样的，但可以利用反射的 newInstance() 方法创建</li></ul><h3 id="_4-泛型上下限" tabindex="-1">4. 泛型上下限 <a class="header-anchor" href="#_4-泛型上下限" aria-label="Permalink to &quot;4. 泛型上下限&quot;">​</a></h3><ul><li><code>extends</code> 指定上限，只准传入本类或子孙类：<code>TestUtil&lt;? extends Number&gt; nn = new TestUtil&lt;Integer&gt;();</code></li><li><code>super</code> 指定下限，只准传入本类或超类：<code>TestUtil&lt;? super Integer&gt; nn = new TestUtil&lt;Number&gt;();</code></li></ul><h2 id="五、注解" tabindex="-1">五、注解 <a class="header-anchor" href="#五、注解" aria-label="Permalink to &quot;五、注解&quot;">​</a></h2><blockquote><p>自定义注解和 AOP - 通过切面实现解耦</p></blockquote><p>最常见的就是使用 Spring AOP 切面 + 自定义注解，来实现<strong>统一的操作日志管理</strong></p><p><strong>目的：</strong> 解耦</p><h2 id="六、反射" tabindex="-1">六、反射 <a class="header-anchor" href="#六、反射" aria-label="Permalink to &quot;六、反射&quot;">​</a></h2><h3 id="_1-基础概念" tabindex="-1">1. 基础概念 <a class="header-anchor" href="#_1-基础概念" aria-label="Permalink to &quot;1. 基础概念&quot;">​</a></h3><blockquote><p>在<strong>运行状态</strong>中，对于任意一个类，都能够知道这个类的所有属性和方法；对于任意一个对象，都能够调用它的任意一个方法和属性；</p></blockquote><p><strong>原理：</strong></p><blockquote><p>反射就是把 java 类中的各种成分映射成一个个的 Java 对象<br> 例如：将类中的方法，变量，构造函数等信息，映射成相应的 Method，Field，Constructor等。</p></blockquote><h3 id="_2-使用场景" tabindex="-1">2. 使用场景 <a class="header-anchor" href="#_2-使用场景" aria-label="Permalink to &quot;2. 使用场景&quot;">​</a></h3><ol><li><strong>开发通用框架</strong></li></ol><blockquote><p>比如通过 XML 文件配置的 JavaBean、Filter等，在运行时会加载不同的对象，调用不同的方法</p></blockquote><ol start="2"><li><strong>动态代理</strong></li></ol><blockquote><p>在 AOP 中，要拦截特定的方法，通常都会选择动态代理，而动态代理在 JDK 中就是用反射来实现的</p></blockquote><ol start="3"><li><strong>自定义注解</strong></li></ol><blockquote><p>注解本身仅仅是起到标记作用，它需要利用反射机制，根据注解标记去调用注解解释器，执行行为</p></blockquote><h3 id="_3-小结" tabindex="-1">3. 小结 <a class="header-anchor" href="#_3-小结" aria-label="Permalink to &quot;3. 小结&quot;">​</a></h3><ol><li>每个 java 类运行时都在 JVM 里表现为一个 Class 类对象</li><li>反射类及反射方法的获取，都是通过从列表中搜寻查找匹配的类或方法，所以查找性能会随类的大小、方法多少而变化</li><li>反射也是考虑了线程安全的，放心使用</li><li>反射使用软引用 relectionData 缓存 class 信息，避免每次重新从 JVM 获取带来的开销</li><li>反射调用多次生成新代理 Accessor，而通过字节码生成的则考虑了卸载功能，所以会使用独立的类加载器</li><li>当找到需要的方法，都会copy一份出来，而不是使用原来的实例，从而保证数据隔离</li><li>调度反射方法，最终是由jvm执行invoke0()执行</li></ol><h2 id="七、异常体系" tabindex="-1">七、异常体系 <a class="header-anchor" href="#七、异常体系" aria-label="Permalink to &quot;七、异常体系&quot;">​</a></h2><br><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph LR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A[Throwable] --&gt; C(Exception)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A[Throwable] --&gt; B(Error)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C --&gt; I[RuntimeException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I --&gt; L[ArrithmeticException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L -.- S{{算术异常}}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I --&gt; M[MissingResourceException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">M -.- T{{丢失资源}}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I --&gt; O[NullPointerException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I --&gt; P[IllegalArgumentException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P -.- U{{非法参数异常}}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I --&gt; Q[ArrayIndexOutOfBoundsException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C --&gt; H[非运行时异常]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">H --&gt; J[SQLException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">H --&gt; V[IOException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">H --&gt; K[FileNotFoundException]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">B --&gt; D[VirtulMachineError]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">B --&gt; E[AWTError]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D --&gt; F[StackOverFlowError]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D --&gt; G[OutOfMemoryError]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_1-throwable" tabindex="-1">1. Throwable <a class="header-anchor" href="#_1-throwable" aria-label="Permalink to &quot;1. Throwable&quot;">​</a></h3><p>Throwable 是 Java 语言中所有异常和错误的超类。</p><p>Throwable 包含了其线程创建时线程执行栈堆的快照，它提供了 printStackTrace() 等接口用户获取栈堆跟踪数据等信息。</p><h3 id="_2-error-错误" tabindex="-1">2. Error（错误） <a class="header-anchor" href="#_2-error-错误" aria-label="Permalink to &quot;2. Error（错误）&quot;">​</a></h3><p>Error 类及其子类：程序无法处理的错误。此类错误一般表示是 JVM 出现了错误，此时 JVM 会终止线程。</p><p>这些错误是不受检异常，应用程序也不应该去处理此类错误。</p><h3 id="_3-exception-异常" tabindex="-1">3. Exception（异常） <a class="header-anchor" href="#_3-exception-异常" aria-label="Permalink to &quot;3. Exception（异常）&quot;">​</a></h3><p>程序可以捕获并且可以处理的异常。</p><h5 id="_3-1-运行时异常和编译时异常" tabindex="-1">3.1 运行时异常和编译时异常 <a class="header-anchor" href="#_3-1-运行时异常和编译时异常" aria-label="Permalink to &quot;3.1 运行时异常和编译时异常&quot;">​</a></h5><ul><li><strong>运行时异常</strong></li></ul><p>都是 RuntimeException 类及其子类异常，这些异常一般是由逻辑错误引起的，我们应该应从逻辑层面尽可能的避免这类异常的发生。<br> 运行时异常的特点是 Java 编译器不会检查这类异常</p><ul><li><strong>编译时异常（非运行时异常）</strong></li></ul><p>除 RuntimeException 以外的异常，类型上都属于 Exception 类及其子类，从程序层面上讲是必须处理的异常，不处理就编译不通过。<br> 比如 IOException、SQLException 以及<strong>自定义异常</strong>。</p><h5 id="_3-2-受检异常和不受检异常" tabindex="-1">3.2 受检异常和不受检异常 <a class="header-anchor" href="#_3-2-受检异常和不受检异常" aria-label="Permalink to &quot;3.2 受检异常和不受检异常&quot;">​</a></h5><ul><li><strong>受检异常（编译器要求必须处理的异常）</strong></li></ul><p>除了 RuntimeException 及其子类以外，其他的 Exception 类及其子类都属于可查异常。</p><ul><li><strong>不受检异常（编译器不强制要求处理的异常）</strong></li></ul><p>包括运行时异常（RuntimeException类及其子类）和错误（Error）。</p><h3 id="异常小记" tabindex="-1">异常小记 <a class="header-anchor" href="#异常小记" aria-label="Permalink to &quot;异常小记&quot;">​</a></h3><ol><li>当 try 捕获到异常，catch 语句块里没有处理此异常的情况：此异常会抛给 JVM 处理，finally 里的语句会被执行，然后 JVM 抛异常终止程序。</li><li>不要捕获 Throwable 类，因为它也会捕获所有错误，而错误不应该被程序处理。</li></ol><h1 id="集合" tabindex="-1">集合 <a class="header-anchor" href="#集合" aria-label="Permalink to &quot;集合&quot;">​</a></h1><h2 id="一、关系图" tabindex="-1">一、关系图 <a class="header-anchor" href="#一、关系图" aria-label="Permalink to &quot;一、关系图&quot;">​</a></h2><p><img src="/myBlog/imgs/20230130182506.png" alt="" loading="lazy"></p><p>ArrayList 动态数组 <br> LinkedList 双向链表 <br> Stack 栈 <br> Queue 队列 <br> Deque 双端队列 <br> ArrayDeque 循环数组 <br> PriorityQueue 优先队列 <br> HashSet 哈希集 <br> HashMap 映射 <br></p><h2 id="二、快速失败和安全失败机制" tabindex="-1">二、快速失败和安全失败机制 <a class="header-anchor" href="#二、快速失败和安全失败机制" aria-label="Permalink to &quot;二、快速失败和安全失败机制&quot;">​</a></h2><ul><li><strong>快速失败</strong>（fail-fast）：当集合改变时，直接抛出异常，结束程序</li></ul><blockquote><p>当我们在使用迭代器遍历元素时，如果集合的 <code>modCount</code> 被修改的话，就会抛出 <code>ConcurrentModificationException</code> 异常。<br> 每当迭代器使用 <code>next()</code> 或 <code>hasNext()</code> 时，都会检查 <code>modCount</code> 变量是否跟 <code>expectedModCount</code> 相同。 <br><strong>场景：</strong> ArrayList、LinkedList、。。。</p></blockquote><ul><li><strong>安全失败</strong>（fail-safe）：当集合改变时，不会抛异常，但操作的始终都是改变前的集合</li></ul><blockquote><p>在遍历时不会在原集合上操作，而是操作原集合的拷贝，所以如果操作过程中，原集合 <code>modCount</code> 改变了，并不会影响现在的操作。<br> 优点是避免了异常，但缺点是如果原集合发送改变的话，遍历器是不知道的。 <br><strong>场景：</strong> JUC包下的容器都是安全失败的，可以在并发环境下使用</p></blockquote><h2 id="三、arraylist" tabindex="-1">三、ArrayList <a class="header-anchor" href="#三、arraylist" aria-label="Permalink to &quot;三、ArrayList&quot;">​</a></h2><blockquote><p>ArrayList 是<strong>动态数组</strong>，底层通过数组实现，有序，允许存储 <code>null</code>，线程不安全，适合查找和遍历，不适合插入和删除</p></blockquote><h3 id="_1-底层数据结构" tabindex="-1">1. 底层数据结构 <a class="header-anchor" href="#_1-底层数据结构" aria-label="Permalink to &quot;1. 底层数据结构&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] elementData; 			</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 用以存放元素，transient 表示该字段不会被序列化和反序列化</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size;							</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 元素个数，Capacity 是容量，两者不一样</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;		</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 该字段继承自 AbstractList&lt;E&gt;，用以记录集合修改次数</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-构造方法" tabindex="-1">2. 构造方法 <a class="header-anchor" href="#_2-构造方法" aria-label="Permalink to &quot;2. 构造方法&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ArrayList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">from</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Integer.MAX_VALUE) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> initialCapacity)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ArrayList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ArrayList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Collection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> extends E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_3-自动扩容" tabindex="-1">3. 自动扩容 <a class="header-anchor" href="#_3-自动扩容" aria-label="Permalink to &quot;3. 自动扩容&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minCapacity) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// overflow-conscious code</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> elementData.length;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (oldCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (newCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		newCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minCapacity;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (newCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MAX_ARRAY_SIZE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		newCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hugeCapacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(minCapacity);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// minCapacity is usually close to size, so this is a win:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	elementData </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Arrays.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">copyOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(elementData, newCapacity);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hugeCapacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minCapacity) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (minCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// overflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OutOfMemoryError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (minCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MAX_ARRAY_SIZE) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Integer.MAX_VALUE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MAX_ARRAY_SIZE;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_4-添加元素" tabindex="-1">4. 添加元素 <a class="header-anchor" href="#_4-添加元素" aria-label="Permalink to &quot;4. 添加元素&quot;">​</a></h3><ul><li><code>add(E e)</code>：添加元素到末尾</li><li><code>add(int index, E e)</code>：在指定位置添加元素，需要移动元素位置，线性时间复杂度</li><li><code>addAll(Collection&lt;? extends E&gt; c)</code></li><li><code>addAll(int index, Collection&lt;? extends E&gt; c)</code></li></ul><blockquote><p>在添加元素前都要进行剩余空间检查，也就是要执行 <code>ensureCapacityInternal(size + 1)</code> 方法</p></blockquote><h3 id="_5-删除元素" tabindex="-1">5. 删除元素 <a class="header-anchor" href="#_5-删除元素" aria-label="Permalink to &quot;5. 删除元素&quot;">​</a></h3><ul><li><code>remove(int index)</code>：<code>index</code> 后的元素向前覆盖，并将最后一个元素设为 <code>null</code></li><li><code>remove(Object o)</code>：如果 <code>o</code> 为 <code>null</code> 的话移除第一个 <code>null</code>，如果 <code>o</code> 不为 <code>null</code> 的话移除第一个相等元素，然后将最后一个元素设为 <code>null</code></li><li><code>removeAll(Collection&lt;?&gt; c)</code>：若原数组包含 <code>c</code> 中的元素，则由后方元素向前覆盖，并将多余的元素设为 <code>null</code></li><li><code>clear()</code>：将数组内所有位置上的元素全设置为 <code>null</code></li></ul><h3 id="_6-修改元素" tabindex="-1">6. 修改元素 <a class="header-anchor" href="#_6-修改元素" aria-label="Permalink to &quot;6. 修改元素&quot;">​</a></h3><ul><li><code>set(int index, E element)</code>：直接通过索引设置，并返回旧元素</li></ul><h3 id="_7-获取元素" tabindex="-1">7 获取元素 <a class="header-anchor" href="#_7-获取元素" aria-label="Permalink to &quot;7 获取元素&quot;">​</a></h3><ul><li><code>get(int index)</code>：直接通过索引获取</li><li><code>indexOf(Object o)</code>：获取元素第一次出现的位置（索引）</li><li><code>lastIndexOf(Object o)</code>：获取元素最后一次出现的位置（索引）</li></ul><h3 id="_8-序列化和反序列化" tabindex="-1">8. 序列化和反序列化 <a class="header-anchor" href="#_8-序列化和反序列化" aria-label="Permalink to &quot;8. 序列化和反序列化&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] elementData;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> writeObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(java.io.ObjectOutputStream s)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> readObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(java.io.ObjectInputStream s)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>因为 size-1 后的所有元素都是 <code>null</code>，所以并不能序列化全数组，而 <code>writeObject()</code> 和 <code>readObject()</code> 方法用于只序列化和反序列化真实元素</p></blockquote><h3 id="_9-其他方法" tabindex="-1">9. 其他方法 <a class="header-anchor" href="#_9-其他方法" aria-label="Permalink to &quot;9. 其他方法&quot;">​</a></h3><ul><li><code>trimToSize()</code>：将底层数组的容量调整为真实元素的数量，简而言之，就是将 <code>Capacity</code> 设置为 <code>size</code></li></ul><h2 id="四、linkedlist" tabindex="-1">四、LinkedList <a class="header-anchor" href="#四、linkedlist" aria-label="Permalink to &quot;四、LinkedList&quot;">​</a></h2><blockquote><p>LinkedList 是双向链表，底层通过双向链表实现，有序，允许存储 null，线程不安全，适合插入和删除，不适合查找</p></blockquote><h3 id="_1-底层数据结构-1" tabindex="-1">1. 底层数据结构 <a class="header-anchor" href="#_1-底层数据结构-1" aria-label="Permalink to &quot;1. 底层数据结构&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;				</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 节点个数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; first;			</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 永远指向第一个节点</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; last;				</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 永远指向最后一个节点</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {		</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 节点类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	E item;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; next;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; prev;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	Node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, E </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.item </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.next </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> next;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.prev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prev;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_2-构造方法-1" tabindex="-1">2. 构造方法 <a class="header-anchor" href="#_2-构造方法-1" aria-label="Permalink to &quot;2. 构造方法&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LinkedList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LinkedList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Collection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> extends E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	addAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(c);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_3-添加元素" tabindex="-1">3. 添加元素 <a class="header-anchor" href="#_3-添加元素" aria-label="Permalink to &quot;3. 添加元素&quot;">​</a></h3><ul><li><code>add(E e)</code>：添加到尾节点的后面</li><li><code>add(int index, E e)</code>：插入到指定位置，也就是插入到原 <code>index</code> 位置节点的前面</li><li><code>addAll(Collection&lt;? extends E&gt; c)</code></li><li><code>addAll(int index, Collection&lt;? extends E&gt; c)</code></li></ul><h3 id="_4-删除元素" tabindex="-1">4. 删除元素 <a class="header-anchor" href="#_4-删除元素" aria-label="Permalink to &quot;4. 删除元素&quot;">​</a></h3><ul><li><code>remove()</code>：调用的是 <code>removeFirst()</code></li><li><code>remove(int index)</code>：将当前节点与其前后节点的联系断掉，并设为 null</li><li><code>remove(Object o)</code>：同上</li><li><code>removeFirst()</code>：移除头节点：先断联系后设 null，同时兼顾 first 和 last</li><li><code>removeLast()</code>：移除尾节点</li></ul><h3 id="_5-修改元素" tabindex="-1">5. 修改元素 <a class="header-anchor" href="#_5-修改元素" aria-label="Permalink to &quot;5. 修改元素&quot;">​</a></h3><ul><li><code>set(int index, E e)</code>：通过遍历索引找到节点后，直接设值</li></ul><h3 id="_6-查找元素" tabindex="-1">6. 查找元素 <a class="header-anchor" href="#_6-查找元素" aria-label="Permalink to &quot;6. 查找元素&quot;">​</a></h3><ul><li><code>get(int index)</code>：通过遍历索引找到节点元素</li><li><code>indexOf(Object o)</code>：顺序遍历查找元素第一次出现索引</li><li><code>lastIndexOf(Object o)</code>：倒序遍历查找元素第一次出现索引</li></ul><h2 id="五、stack-queue-deque" tabindex="-1">五、Stack &amp; Queue &amp; Deque <a class="header-anchor" href="#五、stack-queue-deque" aria-label="Permalink to &quot;五、Stack &amp; Queue &amp; Deque&quot;">​</a></h2><blockquote><p>当需要使用栈时，<code>Java</code> 已不推荐使用 <code>Stack</code>，而是推荐使用更高效的 <code>ArrayDeque</code> <br><code>ArrayDeque</code> 实现自 <code>Deque</code> 接口，是个双向队列，底层通过<strong>动态循环数组</strong>实现，不允许存储 <code>null</code></p></blockquote><h3 id="_1-底层数据结构-2" tabindex="-1">1. 底层数据结构 <a class="header-anchor" href="#_1-底层数据结构-2" aria-label="Permalink to &quot;1. 底层数据结构&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] elements;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> head;				</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 指向真实元素首端的第一个位置所在索引</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tail;				</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 指向真实元素尾端的下一个位置所在索引，当 head == tail 时，表示队列已满</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-扩容" tabindex="-1">2. 扩容 <a class="header-anchor" href="#_2-扩容" aria-label="Permalink to &quot;2. 扩容&quot;">​</a></h3><blockquote><p>其逻辑是申请一个更大的数组(原数组的两倍)，然后将原数组复制过去</p></blockquote><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> doubleCapacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> head </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tail;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> head;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> elements.length;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// number of elements to the right of p</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (newCapacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IllegalStateException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Sorry, deque too big&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[newCapacity];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arraycopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(elements, p, a, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, r);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arraycopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(elements, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, a, r, p);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	elements </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	head </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	tail </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><img src="/myBlog/imgs/20230201191728.png" alt="" loading="lazy"></p><h3 id="_3-方法映射" tabindex="-1">3. 方法映射 <a class="header-anchor" href="#_3-方法映射" aria-label="Permalink to &quot;3. 方法映射&quot;">​</a></h3><blockquote><p><code>add</code>/<code>offer</code>、<code>remove</code>/<code>poll</code>、<code>get</code>/<code>peek</code> 区别是：操作失败的话，前者会抛异常，而后者会返回 <code>false</code> 或 <code>null</code></p></blockquote><table tabindex="0"><thead><tr><th>操作</th><th><code>ArrayQueue</code>/<code>Deque</code> 方法</th><th><code>Stack</code> 方法</th><th><code>Queue</code> 方法</th></tr></thead><tbody><tr><td>入栈</td><td><code>addFirst(e)</code></td><td><code>push()</code></td><td></td></tr><tr><td></td><td><code>offerFirst(e)</code></td><td></td><td></td></tr><tr><td>出栈/出队列</td><td><code>removeFirst()</code></td><td><code>pop()</code></td><td><code>remove()</code></td></tr><tr><td></td><td><code>pollFirst()</code></td><td></td><td><code>poll()</code></td></tr><tr><td>获取栈顶、队列首元素</td><td><code>getFirst()</code></td><td><code>peek()</code></td><td><code>element()</code></td></tr><tr><td></td><td><code>peekFirst()</code></td><td></td><td><code>peek()</code></td></tr><tr><td>入队列</td><td><code>addLast(e)</code></td><td></td><td><code>add(e)</code></td></tr><tr><td></td><td><code>offerLast(e)</code></td><td></td><td><code>offer(e)</code></td></tr><tr><td></td><td><code>removeLast()</code></td><td></td><td></td></tr><tr><td></td><td><code>pollLast()</code></td><td></td><td></td></tr><tr><td></td><td><code>getLast()</code></td><td></td><td></td></tr><tr><td></td><td><code>peekLast()</code></td><td></td><td></td></tr></tbody></table><h2 id="六、priorityqueue" tabindex="-1">六、PriorityQueue <a class="header-anchor" href="#六、priorityqueue" aria-label="Permalink to &quot;六、PriorityQueue&quot;">​</a></h2><blockquote><p>PriorityQueue 是个小顶堆，底层通过动态数组实现，不允许存储 <code>null</code> <br> 默认是权值越小越优先</p></blockquote><h3 id="_1-小顶堆" tabindex="-1">1. 小顶堆 <a class="header-anchor" href="#_1-小顶堆" aria-label="Permalink to &quot;1. 小顶堆&quot;">​</a></h3><p><img src="/myBlog/imgs/20230202191728.png" alt="" loading="lazy"></p><p><strong>父子节点关系：</strong></p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leftNo   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nodeNo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rightNo  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nodeNo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parentNo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nodeNo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-底层数据结构" tabindex="-1">2. 底层数据结构 <a class="header-anchor" href="#_2-底层数据结构" aria-label="Permalink to &quot;2. 底层数据结构&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] queue;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Comparator&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> super</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; comparator;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_3-扩容" tabindex="-1">3. 扩容 <a class="header-anchor" href="#_3-扩容" aria-label="Permalink to &quot;3. 扩容&quot;">​</a></h3><ul><li><code>grow(size+1)</code>: 类似于 <code>ArrayList</code> 里的 <code>grow()</code> 函数，就是再申请一个更大的数组，并将原数组的元素复制过去</li></ul><h3 id="_3-入队列" tabindex="-1">3. 入队列 <a class="header-anchor" href="#_3-入队列" aria-label="Permalink to &quot;3. 入队列&quot;">​</a></h3><ul><li><code>add(E e)</code>: 同 <code>offer(E e)</code></li><li><code>offer(E e)</code>: 先把新元素添加到数组末尾，然后逐层与父节点比较并交换，直至满足比较规则</li></ul><h3 id="_4-获取最优先元素" tabindex="-1">4. 获取最优先元素 <a class="header-anchor" href="#_4-获取最优先元素" aria-label="Permalink to &quot;4. 获取最优先元素&quot;">​</a></h3><ul><li><code>peek()</code>: 获取队首元素，就是下标为 <code>0</code> 的堆顶元素</li></ul><h3 id="_5-出队列" tabindex="-1">5. 出队列 <a class="header-anchor" href="#_5-出队列" aria-label="Permalink to &quot;5. 出队列&quot;">​</a></h3><ul><li><code>poll()</code>: 弹出最优先元素，就是下标为 <code>0</code> 的堆顶元素</li></ul><h3 id="_6-其他方法" tabindex="-1">6. 其他方法 <a class="header-anchor" href="#_6-其他方法" aria-label="Permalink to &quot;6. 其他方法&quot;">​</a></h3><ul><li><code>remove(Object o)</code>: 可分为2种情况：<br><ul><li><ol><li>删除的是最后一个元素。直接删除即可，不需要调整</li></ol></li><li><ol start="2"><li>删除的不是最后一个元素，从删除点开始以最后一个元素为参照调用一次 <code>siftDown()</code> 即可</li></ol></li></ul></li></ul><h2 id="七、hashmap-hashset" tabindex="-1">七、HashMap &amp; HashSet <a class="header-anchor" href="#七、hashmap-hashset" aria-label="Permalink to &quot;七、HashMap &amp; HashSet&quot;">​</a></h2><blockquote><p>在 <code>Java</code> 中，由于 <code>HashMap</code> 和 <code>HashSet</code> 有着相同的实现，所以就放在一起了。<br> 而前者仅仅是对后者做了一层包装，也就是说 <code>HashSet</code> 里面有个 <code>HashMap</code> （适配器模式）</p></blockquote><h3 id="_1-java7-和-java8-的区别" tabindex="-1">1. Java7 和 Java8 的区别 <a class="header-anchor" href="#_1-java7-和-java8-的区别" aria-label="Permalink to &quot;1. Java7 和 Java8 的区别&quot;">​</a></h3><blockquote><p><code>Java8</code> 对 <code>HashMap</code> 进行了一些修改，最大的不同就是其底层数据结构利用了红黑树，所以其由 数组+链表+红黑树 实现<br> 而 <code>Java7</code> 是由 数组+链表 实现</p></blockquote><h3 id="_2-底层数据结构-1" tabindex="-1">2. 底层数据结构 <a class="header-anchor" href="#_2-底层数据结构-1" aria-label="Permalink to &quot;2. 底层数据结构&quot;">​</a></h3><p><img src="/myBlog/imgs/20230204592.png" alt="" loading="lazy"></p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;[] table;						</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 节点数组</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Set&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Entry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; entrySet;				</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 包含所有映射的 Set 视图</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size;									</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 数组中真实元素的个数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">transient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modCount;								</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改次数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> threshold;										</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 扩容临界值，threshold = capacity * loadFactor</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> loadFactor;								</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 加载因子，默认值是 0.75f</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 链表节点</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map.Entry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hash;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> K key;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	V value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; next;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	Node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, K </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hash;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.next </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> next;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 红黑树节点</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TreeNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LinkedHashMap.Entry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	TreeNode&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; parent;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// red-black tree links</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	TreeNode&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; left;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	TreeNode&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; right;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	TreeNode&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; prev;    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// needed to unlink next upon deletion</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> red;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	TreeNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> hash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, K </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hash, key, val, next);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="_3-扩容-1" tabindex="-1">3. 扩容 <a class="header-anchor" href="#_3-扩容-1" aria-label="Permalink to &quot;3. 扩容&quot;">​</a></h3><p>参考：<a href="https://tobebetterjavaer.com/collection/hashmap.html#%E4%BA%8C%E3%80%81%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6" target="_blank" rel="noreferrer">https://tobebetterjavaer.com/collection/hashmap.html#%E4%BA%8C%E3%80%81%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6</a></p><p><strong>关键点：</strong></p><ol><li>扩容的流程：将旧数组上的数据重新分配到新数组上</li><li>在数据重新分配的过程中，Java7 会计算 hash 值，而 Java8 不会。</li><li>Java8 重新分配数据：只需要看原来的 hash 值新增的那个 bit 是 1 还是 0 就好了，是 0 的话就表示索引没变，是 1 的话，索引就变成了“原索引+原来的容量”</li></ol><h3 id="_4-put过程分析" tabindex="-1">4. put过程分析 <a class="header-anchor" href="#_4-put过程分析" aria-label="Permalink to &quot;4. put过程分析&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> V </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(K key, V value) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> putVal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key), key, value, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 第四个参数 onlyIfAbsent 如果是 true，那么只有在不存在该 key 时才会进行 put 操作</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 第五个参数 evict 我们这里不关心</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> V </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">putVal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hash, K key, V value, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> onlyIfAbsent,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">               boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> evict) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;[] tab; Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; p; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n, i;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 第一次 put 值的时候，会触发下面的 resize()，类似 java7 的第一次 put 也要初始化数组长度</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 第一次 resize 和后续的扩容有些不一样，因为这次是数组从 null 初始化到默认的 16 或自定义的初始容量</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((tab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tab.length) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (tab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()).length;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 找到具体的数组下标，如果此位置没有值，那么直接初始化一下 Node 并放置在这个位置就可以了</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tab[i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hash]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        tab[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> newNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hash, key, value, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 数组该位置有数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Node&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">V</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; e; K k;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 首先，判断该位置的第一个数据和我们要插入的数据，key 是不是&quot;相等&quot;，如果是，取出这个节点</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (p.hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ((k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p.key) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(k))))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 如果该节点是代表红黑树的节点，调用红黑树的插值方法，本文不展开说红黑树</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TreeNode)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((TreeNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">K,V</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)p).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">putTreeVal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tab, hash, key, value);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 到这里，说明数组该位置上是一个链表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> binCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; ; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">binCount) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 插入到链表的最后面(Java7 是插入到链表的最前面)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p.next) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    p.next </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> newNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hash, key, value, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    // TREEIFY_THRESHOLD 为 8，所以，如果新插入的值是链表中的第 8 个</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    // 会触发下面的 treeifyBin，也就是将链表转换为红黑树</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (binCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TREEIFY_THRESHOLD </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// -1 for 1st</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        treeifyBin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tab, hash);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 如果在该链表中找到了&quot;相等&quot;的 key(== 或 equals)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (e.hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    ((k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e.key) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(k))))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    // 此时 break，那么 e 为链表中[与要插入的新值的 key &quot;相等&quot;]的 node</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                    break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // e!=null 说明存在旧值的key与要插入的key&quot;相等&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 对于我们分析的put操作，下面这个 if 其实就是进行 &quot;值覆盖&quot;，然后返回旧值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            V oldValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e.value;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">onlyIfAbsent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                e.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            afterNodeAccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> oldValue;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">modCount;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 如果 HashMap 由于新插入这个值导致 size 已经超过了阈值，需要进行扩容</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> threshold)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        resize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    afterNodeInsertion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(evict);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p><img src="/myBlog/imgs/68747470733.png" alt="" loading="lazy"></p><h3 id="_5-get过程分析" tabindex="-1">5. get过程分析 <a class="header-anchor" href="#_5-get过程分析" aria-label="Permalink to &quot;5. get过程分析&quot;">​</a></h3><ol><li>计算 key 的 hash 值，根据 hash 值找到对应数组下标: hash &amp; (length-1)</li><li>判断数组该位置处的元素是否刚好就是我们要找的，如果不是，走第三步</li><li>判断该元素类型是否是 TreeNode，如果是，用红黑树的方法取数据，如果不是，走第四步</li><li>遍历链表，直到找到相等(==或equals)的 key</li></ol><p><strong>为什么要覆写hashCode()和equals()？</strong></p><blockquote><p><code>hashCode()</code> 方法决定了对象会被放到哪个 <code>bucket</code> 里，当多个对象的哈希值冲突时，equals()` 方法决定了这些对象是否是“同一个对象”</p></blockquote><p><br><br> 《算法导论》中对于红黑树的定义如下：<br></p><ol><li>每个节点或是红色的，或是黑色的</li><li>根节点上黑色的</li><li>每个叶节点都是黑色的</li><li>如果一个节点是红色的，咋它的两个子节点都是黑色的（也就是说，红色节点不能挨着）</li><li>对每个节点，从该节点到其子孙结点的所有路径上包含相同数目的黑色节点（黑色节点平衡）</li></ol><h3 id="_7-hashset" tabindex="-1">7. HashSet <a class="header-anchor" href="#_7-hashset" aria-label="Permalink to &quot;7. HashSet&quot;">​</a></h3><blockquote><p><code>HashSet</code> 就是对 <code>HashMap</code> 的简单包装，对 <code>HashSet</code> 的函数调用都会转换成合适的 <code>HashMap</code> 方法</p></blockquote><h2 id="八、weakhashmap" tabindex="-1">八、WeakHashMap <a class="header-anchor" href="#八、weakhashmap" aria-label="Permalink to &quot;八、WeakHashMap&quot;">​</a></h2><p>一个特殊的集合：<code>WeakHashMap</code>，从名字可以看出它是某种 <code>Map</code>。它的特殊之处在于里面的 <code>entry</code> 可能会被<strong>GC自动删除</strong>， 即使程序员没有调用 <code>remove()</code> 或者 <code>clear()</code> 方法。简单来说，就是它存储的数据不知道什么时候就被清除了</p><p><code>WeakHashMap</code> 的这个特点特别适用于需要<strong>缓存</strong>的场景</p><p><strong>原理：</strong> 弱引用</p><blockquote><p>虽然弱引用可以用来访问对象，但进行垃圾回收时弱引用并不会被考虑在内，仅有弱引用指向的对象仍然会被GC回收。 而 <code>WeakHashMap</code> 内部是通过弱引用来管理 <code>entry</code> 的</p></blockquote><h1 id="java-多线程与并发" tabindex="-1">Java 多线程与并发 <a class="header-anchor" href="#java-多线程与并发" aria-label="Permalink to &quot;Java 多线程与并发&quot;">​</a></h1><h2 id="一、线程基础" tabindex="-1">一、线程基础 <a class="header-anchor" href="#一、线程基础" aria-label="Permalink to &quot;一、线程基础&quot;">​</a></h2><h3 id="_1-线程调度" tabindex="-1">1. 线程调度 <a class="header-anchor" href="#_1-线程调度" aria-label="Permalink to &quot;1. 线程调度&quot;">​</a></h3><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Thread</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Runnable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> State</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        NEW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,						</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 新建</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        RUNNABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,					</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可运行</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        BLOCKED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,					</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 阻塞</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        WAITING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,					</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 无限期等待</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        TIMED_WAITING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,				</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 限期等待</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        TERMINATED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;					</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 死亡/结束</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><img src="/myBlog/imgs/2023020619024859.png" alt="" loading="lazy"></p><table tabindex="0"><thead><tr><th>方法</th><th>作用</th><th>区别</th></tr></thead><tbody><tr><td>start()</td><td>启动线程</td><td>线程进入就绪态</td></tr><tr><td>run()</td><td>线程逻辑代码处理，由 JVM 自动调用</td><td>线程进入运行态</td></tr><tr><td>sleep()</td><td>休眠当前线程</td><td>不释放锁</td></tr><tr><td>wait()</td><td>使当前线程等待</td><td>释放锁</td></tr><tr><td>notify()</td><td>唤醒此对象监视器上等待的单个线程</td><td>针对单个线程</td></tr><tr><td>notifyAll()</td><td>唤醒在此对象监视器上等待的所有线程</td><td>针对多个线程</td></tr><tr><td>join()</td><td>等待线程执行完毕</td><td>线程对象调用</td></tr><tr><td>yield()</td><td>让位：当前线程退出运行态，进入就绪态</td><td>Thread 类调用</td></tr></tbody></table><p><strong>当调用 <code>start()</code> 方法启动一个线程时，虚拟机会将该线程放入就绪队列中等待被调度，当一个线程被调度时会执行该线程的 <code>run()</code> 方法</strong></p><h3 id="_2-创建线程" tabindex="-1">2. 创建线程 <a class="header-anchor" href="#_2-创建线程" aria-label="Permalink to &quot;2. 创建线程&quot;">​</a></h3><h5 id="_2-1-实现-runnable-接口-优先" tabindex="-1">2.1 实现 Runnable 接口(优先) <a class="header-anchor" href="#_2-1-实现-runnable-接口-优先" aria-label="Permalink to &quot;2.1 实现 Runnable 接口(优先)&quot;">​</a></h5><blockquote><p>需要实现 <code>run()</code> 方法</p></blockquote><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyRunnable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Runnable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] args) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    MyRunnable instance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyRunnable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Thread thread </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Thread</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(instance);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="_2-2-实现-callable-接口" tabindex="-1">2.2 实现 Callable 接口 <a class="header-anchor" href="#_2-2-实现-callable-接口" aria-label="Permalink to &quot;2.2 实现 Callable 接口&quot;">​</a></h5><blockquote><p>实现 <code>call()</code> 方法，且有返回值，返回值通过 <code>FutureTask</code> 封装</p></blockquote><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyCallable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Callable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Integer </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] args) throws ExecutionException, InterruptedException {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    MyCallable mc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyCallable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    FutureTask&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; ft </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FutureTask&lt;&gt;(mc);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Thread thread </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Thread</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ft);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ft.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="_2-3-继承-thread-类" tabindex="-1">2.3 继承 Thread 类 <a class="header-anchor" href="#_2-3-继承-thread-类" aria-label="Permalink to &quot;2.3 继承 Thread 类&quot;">​</a></h5><blockquote><p>也需要实现 <code>run()</code> 方法，因为 <code>Thread</code> 类也实现了 <code>Runnable</code> 接口</p></blockquote><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyThread</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Thread</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] args) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    MyThread mt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyThread</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>实现接口比继承类更好，因为：</strong> <br></p><ul><li>Java 不支持多重继承，因此继承了 <code>Thread</code> 类就无法继承其它类，但是可以实现多个接口</li><li>类可能只要求可执行就行，继承整个 <code>Thread</code> 类开销过大</li></ul><h3 id="_3-wait-和sleep" tabindex="-1">3. wait()和sleep() <a class="header-anchor" href="#_3-wait-和sleep" aria-label="Permalink to &quot;3. wait()和sleep()&quot;">​</a></h3><ul><li><code>wait</code> 方法必须在 <code>synchronized</code> 保护的代码中使用，而 <code>sleep</code> 方法并没有这个要求。</li><li><code>wait</code> 方法会主动释放 <code>monitor</code> 锁，在同步代码中执行 <code>sleep</code> 方法时，并不会释放 <code>monitor</code> 锁。</li><li><code>wait</code> 方法意味着永久等待，直到被中断或被唤醒才能恢复，不会主动恢复，<code>sleep</code> 方法中会定义一个时间，时间到期后会主动恢复。</li><li><code>wait/notify</code> 是 <code>Object</code> 类的方法，而 <code>sleep</code> 是 <code>Thread</code> 类的方法。</li></ul><h3 id="_4-threadlocal" tabindex="-1">4. ThreadLocal <a class="header-anchor" href="#_4-threadlocal" aria-label="Permalink to &quot;4. ThreadLocal&quot;">​</a></h3><h5 id="_4-1-简介" tabindex="-1">4.1 简介： <a class="header-anchor" href="#_4-1-简介" aria-label="Permalink to &quot;4.1 简介：&quot;">​</a></h5><blockquote><p>通常情况下，我们创建的变量是可以被任何一个线程访问并修改的。如果想实现每一个线程都有自己的专属本地变量该如何解决呢？ <br> JDK中提供的 <code>ThreadLocal</code> 类正是为了解决这样的问题。类似操作系统中的 TLAB</p></blockquote><h5 id="_4-2-原理" tabindex="-1">4.2 原理 <a class="header-anchor" href="#_4-2-原理" aria-label="Permalink to &quot;4.2 原理&quot;">​</a></h5><blockquote><p>首先 <code>ThreadLocal</code> 是一个泛型类，保证可以接受任何类型的对象。因为一个线程内可以存在多个 <code>ThreadLocal </code>对象， 所以其实是 <code>ThreadLocal</code> 内部维护了一个 <code>Map</code> ，是 <code>ThreadLocal</code> 实现的一个叫做 <code>ThreadLocalMap </code>的静态内部类。</p><p>最终的变量是放在了当前线程的 <code>ThreadLocalMap</code> 中，并不是存在 <code>ThreadLocal</code> 上，<code>ThreadLocal</code> 可以理解为只是 <code>ThreadLocalMap</code> 的封装， 传递了变量值。</p><p>我们使用的 <code>get()</code>、<code>set()</code> 方法其实都是调用了这个 <code>ThreadLocalMap</code> 类对应的 <code>get()</code>、<code>set()</code> 方法。</p></blockquote><h5 id="_4-3-使用" tabindex="-1">4.3 使用 <a class="header-anchor" href="#_4-3-使用" aria-label="Permalink to &quot;4.3 使用&quot;">​</a></h5><ol><li>存储用户Session</li></ol><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ThreadLocal threadSession </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ThreadLocal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li>解决线程安全的问题</li></ol><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ThreadLocal&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SimpleDateFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; format1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ThreadLocal&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SimpleDateFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h5 id="_4-4-threadlocal内存泄漏的场景" tabindex="-1">4.4 ThreadLocal内存泄漏的场景 <a class="header-anchor" href="#_4-4-threadlocal内存泄漏的场景" aria-label="Permalink to &quot;4.4 ThreadLocal内存泄漏的场景&quot;">​</a></h5><blockquote><p>实际上 <code>ThreadLocalMap</code> 中使用的 <code>key</code> 为 <code>ThreadLocal</code> 的弱引用，而 <code>value</code> 是强引用。 弱引用的特点是，如果这个对象持有弱引用，那么在下一次垃圾回收的时候必然会被清理掉。</p><p>所以如果 <code>ThreadLocal</code> 没有被外部强引用的情况下，在垃圾回收的时候会被清理掉的， 这样一来 <code>ThreadLocalMap</code> 中使用这个 <code>ThreadLocal</code> 的 <code>key</code> 也会被清理掉。 但是，<code>value</code> 是强引用，不会被清理，这样一来就会出现 <code>key</code> 为 <code>null</code> 的 <code>value</code>。 假如我们不做任何措施的话，<code>value</code> 永远无法被 GC 回收，如果线程长时间不被销毁，可能会产生内存泄露。</p></blockquote><p><img src="/myBlog/imgs/68747470733a2e67.png" alt="" loading="lazy"></p><p>​<code>ThreadLocalMap</code> 实现中已经考虑了这种情况，在调用 <code>set()</code>、<code>get()</code>、<code>remove()</code> 方法的时候，会清理掉 <code>key</code> 为 <code>null</code> 的记录。 如果说会出现内存泄漏，那只有在出现了 <code>key</code> 为 <code>null</code> 的记录后，没有手动调用 <code>remove()</code> 方法， 并且之后也不再调用 <code>get()</code>、<code>set()</code>、<code>remove()</code> 方法的情况下。因此使用完 <code>ThreadLocal</code> 方法后，最好手动调用 <code>remove()</code> 方法。</p><h2 id="二、" tabindex="-1">二、 <a class="header-anchor" href="#二、" aria-label="Permalink to &quot;二、&quot;">​</a></h2><h2 id="三、" tabindex="-1">三、 <a class="header-anchor" href="#三、" aria-label="Permalink to &quot;三、&quot;">​</a></h2><p><br><br><br><br><br><br><br><br> synchronized和ReentrantLock、Condition类</p><h1 id="jvm" tabindex="-1">JVM <a class="header-anchor" href="#jvm" aria-label="Permalink to &quot;JVM&quot;">​</a></h1><h2 id="一、类加载机制" tabindex="-1">一、类加载机制 <a class="header-anchor" href="#一、类加载机制" aria-label="Permalink to &quot;一、类加载机制&quot;">​</a></h2><h3 id="_1-class-字节码文件" tabindex="-1">1. class 字节码文件 <a class="header-anchor" href="#_1-class-字节码文件" aria-label="Permalink to &quot;1. class 字节码文件&quot;">​</a></h3><br><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph LR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A[Java 源码文件] --Java 编译器--&gt; B[class 字节码文件] --JVM 虚拟机--&gt; C[计算机指令]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_2-类加载过程" tabindex="-1">2. 类加载过程 <a class="header-anchor" href="#_2-类加载过程" aria-label="Permalink to &quot;2. 类加载过程&quot;">​</a></h3><p>类加载过程包括了<strong>加载</strong>、<strong>验证</strong>、<strong>准备</strong>、<strong>解析</strong>和<strong>初始化</strong>五个阶段</p><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph LR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A[加载 Loading] --&gt; B[验证 Verifying]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">subgraph 连接 Linking</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">B --&gt; C[准备 Preparing]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C --&gt; D[解析 Resolving]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D --&gt; E[初始化 Initiallsing]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="_2-1-加载过程" tabindex="-1">2.1 加载过程 <a class="header-anchor" href="#_2-1-加载过程" aria-label="Permalink to &quot;2.1 加载过程&quot;">​</a></h5><ol><li>通过一个类的全限定名获取定义此类的二进制字节流</li><li>将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构</li><li>在 Java 堆中生成一个代表该类的 Class 类对象，作为方法区中这些数据的访问入口</li></ol><h5 id="_2-2-验证过程" tabindex="-1">2.2 验证过程 <a class="header-anchor" href="#_2-2-验证过程" aria-label="Permalink to &quot;2.2 验证过程&quot;">​</a></h5><ol><li>对二进制字节流进行校验，只有符合 JVM 字节码规范的才能被 JVM 正确执行，确保被加载类的正确性</li><li>主要包括四种验证：文件格式验证、元数据验证、字节码验证、符号引用验证。</li></ol><h5 id="_2-3-准备过程" tabindex="-1">2.3 准备过程 <a class="header-anchor" href="#_2-3-准备过程" aria-label="Permalink to &quot;2.3 准备过程&quot;">​</a></h5><ol><li>为类变量分配内存，并设置为初始零值</li><li>如果同时被 <code>static</code> 和 <code>final</code> 修饰，则该变量在准备过程就会被初始化为指定值</li></ol><h5 id="_2-4-解析过程" tabindex="-1">2.4 解析过程 <a class="header-anchor" href="#_2-4-解析过程" aria-label="Permalink to &quot;2.4 解析过程&quot;">​</a></h5><ol><li>虚拟机将常量池中的符号引用替换为直接引用的过程</li><li>符号引用就是用一组符合来描述目标，直接引用就是直接指向目标的指针/相对偏移量，或者是一个能简介定位到目标的句柄</li><li><strong>字符串常量池：</strong> 堆上，默认class文件的静态常量池       <strong>运行时常量池：</strong> 在方法区，属于元空间</li></ol><h5 id="_2-5-初始化阶段" tabindex="-1">2.5 初始化阶段 <a class="header-anchor" href="#_2-5-初始化阶段" aria-label="Permalink to &quot;2.5 初始化阶段&quot;">​</a></h5><ol><li>初始化阶段就是调用方法 <code>&lt;clinit&gt;()</code> 的过程，<code>&lt;clinit&gt;()</code> 方法是编译后自动生成的</li><li>是加载过程的最后一步，而这一阶段才是真正意义上的开始执行类中定义的 Java 代码</li></ol><h3 id="_3-类加载器" tabindex="-1">3. 类加载器 <a class="header-anchor" href="#_3-类加载器" aria-label="Permalink to &quot;3. 类加载器&quot;">​</a></h3><br><div class="language-mermaid vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph BT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">A[应用类加载器] --&gt; B[扩展类加载器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">B --&gt; C[启动类加载器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D[自定义类加载器] &amp; E[自定义类加载器] --&gt; A</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">注意</p><p>这里的箭头并不是继承，而是组合</p></div><p><strong>双亲委派机制：</strong></p><p>如果一个类加载器收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把请求委托给父加载器去完成，依次向上， 因此，所有的类加载请求最终都应该被传递到顶层的启动类加载器中，只有当父加载器在它的搜索范围中没有找到所需的类时， 即无法完成该加载，子加载器才会尝试自己去加载该类</p><p><strong>好处：</strong> 此机制保证 JDK 核心类的优先加载；使得 Java 程序的稳定运行，可以避免类的重复加载，也保证了 Java 的核心 API 不被篡改。 如果没有使用双亲委派模型，而是每个类加载器加载自己的话就会出现一些问题，比如我们编写一个称为 java.lang.Object 类的话， 那么程序运行的时候，系统就会出现多个不同的 Object 类</p><h2 id="二、内存结构" tabindex="-1">二、内存结构 <a class="header-anchor" href="#二、内存结构" aria-label="Permalink to &quot;二、内存结构&quot;">​</a></h2><h3 id="_1-运行时数据区域" tabindex="-1">1. 运行时数据区域 <a class="header-anchor" href="#_1-运行时数据区域" aria-label="Permalink to &quot;1. 运行时数据区域&quot;">​</a></h3><p>下图是 JVM 整体架构：</p><p><img src="/myBlog/imgs/JVM%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84.png" alt="" loading="lazy"></p><h3 id="_2-堆" tabindex="-1">2. 堆 <a class="header-anchor" href="#_2-堆" aria-label="Permalink to &quot;2. 堆&quot;">​</a></h3><h5 id="_2-1-概述" tabindex="-1">2.1 概述 <a class="header-anchor" href="#_2-1-概述" aria-label="Permalink to &quot;2.1 概述&quot;">​</a></h5><ul><li>Java 堆是 Java 虚拟机管理内存中最大的一块，被所有线程共享。</li><li>此存储区域唯一的目的就是存放对象实例，几乎所有的对象实例及数组都在这里分配内存 <ul><li>之所以是几乎所有的对象，是因为在开启逃逸分析后，某些未逃逸的对象可以通过标量替换的方式在栈中分配内存</li></ul></li></ul><h5 id="_2-2-内存划分" tabindex="-1">2.2 内存划分 <a class="header-anchor" href="#_2-2-内存划分" aria-label="Permalink to &quot;2.2 内存划分&quot;">​</a></h5><blockquote><p><strong>分区的理由是：为了更好的分配内存及 GC</strong></p></blockquote><p>堆内存被划分为：新生代、老年代，对于新生代又被划分为 <code>Eden</code> 区和两个 <code>Surviver</code> 区 (S1/S2)</p><ul><li><strong>新生代：</strong> 是大部分新对象创建的地方。</li><li><strong>老年代：</strong> 包含了那些经过多次小型 GC 后仍然存活的对象</li></ul><h5 id="_2-3-对象分配过程及垃圾回收机制" tabindex="-1">2.3 对象分配过程及垃圾回收机制 <a class="header-anchor" href="#_2-3-对象分配过程及垃圾回收机制" aria-label="Permalink to &quot;2.3 对象分配过程及垃圾回收机制&quot;">​</a></h5><blockquote><p>Java 堆是垃圾回收 (GC) 的主要区域</p></blockquote><p><img src="/myBlog/imgs/%E5%A0%86%E5%88%86%E5%8C%BA.png" alt="" loading="lazy"></p><ol><li>当创建一个对象时，对象会被优先分配到新生代 <code>Eden</code> 区，此时会给对象一个年龄</li><li>如果创建的是大对象时，会被直接分配到老年代，这样做是为了避免在 <code>Eden</code> 和两个 <code>Surviver</code> 区之间发生大量的内存拷贝</li><li>直至 <code>Eden</code> 区内存不够分配时，将执行新生代的垃圾回收<code>（Minor GC）</code></li><li><code>Minor GC</code> 会将新生代的所有对象移动到空 <code>Surviver</code> 区中，并且所有对象年龄+1</li><li>直至新生代中某些对象达到阙值（默认是15），对象会被移动到老年代中</li><li>当老年代内存不足分配时，会触发 <code>Major GC</code>，在 <code>Major GC</code> 后如果内存还不足，就会报 OOM 异常</li><li>每次进行 <code>Minor GC</code> 或者大对象直接进入老年区时，JVM 会计算所需空间如小于老年代的剩余空间，则进行一次 <code>Full GC</code></li><li><code> Full GC</code>：清理整个 Java 堆和方法区的垃圾</li></ol><p><strong>回收算法：</strong></p><ul><li><code>minorGC</code>：标记 - 清除</li><li><code>Major GC</code>：标记 - 整理</li></ul><h3 id="_3-方法区" tabindex="-1">3. 方法区 <a class="header-anchor" href="#_3-方法区" aria-label="Permalink to &quot;3. 方法区&quot;">​</a></h3><ul><li>用于存储已经被 Java 虚拟机加载的类信息、字段信息、方法信息、常量、静态变量等</li><li>方法区只是 Java 虚拟机的一个概念或者叫规范，而元空间/永久代是方法区的落地实现</li></ul><h3 id="_4-程序计数器" tabindex="-1">4. 程序计数器 <a class="header-anchor" href="#_4-程序计数器" aria-label="Permalink to &quot;4. 程序计数器&quot;">​</a></h3><ul><li>程序计数器中存储了下一次要执行指令的地址，由执行引擎读取并执行指令 <br></li><li>因为 CPU 要在多个线程间不停切换，在当线程被切换回来的时候需要知道执行到了哪里，所以每个线程都要有一个属于自己的程序计数器</li></ul><h3 id="_5-java-虚拟机栈" tabindex="-1">5. Java 虚拟机栈 <a class="header-anchor" href="#_5-java-虚拟机栈" aria-label="Permalink to &quot;5. Java 虚拟机栈&quot;">​</a></h3><h5 id="_4-1-概述" tabindex="-1">4.1 概述 <a class="header-anchor" href="#_4-1-概述" aria-label="Permalink to &quot;4.1 概述&quot;">​</a></h5><ul><li>除 Native 方法外，所有 Java 方法的调用都是通过栈来实现的，方法间的数据也都需要栈来传递 <br></li><li>栈都是由一个个栈帧组成，每个栈帧对应一个被调用的方法 <br></li><li>每一次方法的调用都会有一个对应的栈帧入栈，每一个方法的结束都会有一个栈帧出栈 <br></li><li>Java 方法有两种结束的方式：1. 使用 return 指令       2. 抛出异常</li></ul><h5 id="_4-2-栈帧结构" tabindex="-1">4.2 栈帧结构 <a class="header-anchor" href="#_4-2-栈帧结构" aria-label="Permalink to &quot;4.2 栈帧结构&quot;">​</a></h5><p>栈帧包含<strong>局部变量表</strong>、<strong>操作数栈</strong>、<strong>动态链接</strong>、<strong>方法返回地址</strong>、一些附加信息五个部分</p><ul><li><strong>局部变量表：</strong> 用于存储方法参数和方法内部定义的局部变量，包括基础数据类型和引用类型（对象引用）</li><li><strong>操作数栈：</strong> 用于存放方法执行过程中产生的中间计算结果或临时变量</li><li><strong>动态链接：</strong> 在<strong>运行</strong>期间，将符号引用转换为直接引用 <ul><li><strong>符号引用：</strong> 在 Java 源文件被编译到字节码文件中时，所有的变量和方法引用都作为符号引用保存在 Class 文件的<strong>常量池</strong>中。</li></ul></li><li><strong>方法返回地址：</strong> 存放调用该方法的 PC 寄存器的值</li></ul><h3 id="_5-本地方法栈" tabindex="-1">5. 本地方法栈 <a class="header-anchor" href="#_5-本地方法栈" aria-label="Permalink to &quot;5. 本地方法栈&quot;">​</a></h3><blockquote><p>本地方法栈和 Java 虚拟机栈类似，不同的是：<br> Java 虚拟机栈服务的是 Java 方法，而<strong>本地方法栈服务的是 Native 方法</strong></p></blockquote><h2 id="三、垃圾回收机制" tabindex="-1">三、垃圾回收机制 <a class="header-anchor" href="#三、垃圾回收机制" aria-label="Permalink to &quot;三、垃圾回收机制&quot;">​</a></h2><p><br><br><br><br><br><br>stream()流操作 <br><br><br><br><br><br><br><br><br><br><br><br><br><br> 在 JVM 中看：Class 类对象/实例和 .class 字节码文件是什么关系</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/myBlog/04.%E4%BB%A3%E7%A0%81%E5%AE%87%E5%AE%99/10.Java/01.LocalDateTime%E4%BD%BF%E7%94%A8.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>LocalDateTime使用</span><!--]--></a></div></nav></footer><!--[--><!--[--><!--[--><!--[--><!--]--><!--[--><!--[--><!--]--><div class="tk-article-update"><div class="tk-article-update__title flx-align-center"><i class="tk-icon edit-icon" style="--icon-color-hover:var(--tk-theme-color);" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024">
    <path
      fill="currentColor"
      d="m199.04 672.64 193.984 112 224-387.968-193.92-112-224 388.032zm-23.872 60.16 32.896 148.288 144.896-45.696zM455.04 229.248l193.92 112 56.704-98.112-193.984-112-56.64 98.112zM104.32 708.8l384-665.024 304.768 175.936L409.152 884.8h.064l-248.448 78.336zm384 254.272v-64h448v64h-448z"
    ></path>
  </svg></i><span>最近更新</span></div><ul><!--[--><li class="flx-center"><span class="tk-article-update--num" aria-hidden="true">01</span><div class="tk-article-update__content"><a href="/myBlog/01.进化志/01.项目开发到生活思考.html" class="flx-1 hover-color sle" aria-label="项目开发到生活思考"><span class="tk-article-title" aria-label="文章标题"><!--v-if--><!--[--><!--[-->项目开发到生活思考<!--]--><!--]--><!--v-if--></span></a><span class="tk-article-update__content--date">2026-02-18 18:41:18</span></div></li><li class="flx-center"><span class="tk-article-update--num" aria-hidden="true">02</span><div class="tk-article-update__content"><a href="/myBlog/13.热爱清单/01.拍照摄影.html" class="flx-1 hover-color sle" aria-label="拍照摄影"><span class="tk-article-title" aria-label="文章标题"><!--v-if--><!--[--><!--[-->拍照摄影<!--]--><!--]--><!--v-if--></span></a><span class="tk-article-update__content--date">2026-02-18 18:40:18</span></div></li><li class="flx-center"><span class="tk-article-update--num" aria-hidden="true">03</span><div class="tk-article-update__content"><a href="/myBlog/04.代码宇宙/20.框架与库/04.Springboot.html" class="flx-1 hover-color sle" aria-label="Springboot"><span class="tk-article-title" aria-label="文章标题"><!--v-if--><!--[--><!--[-->Springboot<!--]--><!--]--><!--v-if--></span></a><span class="tk-article-update__content--date">2026-02-18 18:33:39</span></div></li><li class="flx-center"><span class="tk-article-update--num" aria-hidden="true"></span><div class="tk-article-update__content"><!--v-if--><!--v-if--></div></li><!--]--></ul></div><!--[--><!--]--><!--]--><!--v-if--><!-- 评论区 --><!--v-if--><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div><!--]--></div>
    
    
  </body>
</html>